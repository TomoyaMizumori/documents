## 数理工学セミナー

## A pooling-LiNGAM algorithm for effective connectivity analysis of fMRI data


## abstract
独立成分分析（ICA）は非ガウス分布西たがうデータ間の因果関係を推定できるアルゴリズムである。
この手法は、人間の脳領域の有効結合を検出するための有望な手法とされている。

### LiNGAMの仮定
- データ生成プロセスは線形であること
- 観測されない交絡因子が存在しないこと
- データは非ガウス分布に従うこと

### LiNGAMの性能に関する課題
- LiNGAMは十分な数のデータポイントがある場合に優れた性能を示す。
- 神経画像データ、fMRI(機能的磁気共鳴画像)データは、データ数が少ないためLiNGAMアルゴリズムが収束しにくい問題

### 解決案の提案
- 複数の被験者のデータポイントを結合する方法
- 異なる被験者のデータをまとめてデータポイント数を増加させることで、アルゴリズムの安定性と収束性を向上させる。
- Pooling-LiNGAM(pLiNGAM)

### この論文について
- シミュレーションデータと実際のfMRIデータを用いて、pLiNGAMの有効結合推定能力に関して実験、検証した。

### 実験結果に関して
- fMRIデータは十分なデータポイントを確保できない
- 複数の被験者を結合して仮想被験者(V-subject)を作成することで、LiNGAMの推定制度を向上させることが可能

## introduction
- 機能的結合と有効結合の解析は神経画像研究において広く使用されている。
- 機能的結合は、空間的に離れた脳領域間の時間的相関を反映します。
- 有効結合は、１つの脳領域が他の脳領域に与える影響を評価する

- このうち有効結合は情報の流れの方向性を記述できるため、認知神経科学の研究における重要なトピックである。

### 有効結合推定の手法
- 有効結合を推定するための代表的な手法は以下の通り
    - 構造方程式モデリング
    - 動的因果モデリング
    - Granger因果性マッピング
    - ベイズネットワーク

- 各種法には課題がある。

### LiNGAMアルゴリズムの登場
#### LiNGAMの特徴
- データ生成プロセスは線形であること
- 観測されない交絡因子はないこと
- 誤差変数は非ガウス分布であること

### LiNGAMの課題
- データポイント数が多い場合は安定して機能するが、多くのfMRI実験ではデータポイント数が少ないためLiNGAMが収束せず、不安定になるという課題がある。

### pLiNGAM
- 被験者ごとのデータポイントをプール（結合）して、より多くのデータポイントをLiNGAMに提供する方法。
- 複数の被験者を組み合わせて生成されるデータセットを仮想被験者(V-subject)と呼ぶ。

### グループ解析手順
- 複数被験者のデータを結合するグループ解析には以下の３つのアプローチがある。

- 仮想的典型被験者法(VTS)
    - 全ての被験者が同じ機能を持ち、同じ結合ネットワークを持つと仮定する。
    - 被験者の変動を考慮しない
- 個別構造法(IS)
    - 各被験者の結合構造を個別に学習し、それをもとにグループ解析を行う。
    - 被験者間の変動を考慮するが、グループデータ全体を十分に統合できない場合がある。
- 共通構造法(CS)
    - 被験者ごとに異なる結合強度を許容しつつ、同じネットワーク構造を共有する。

- pLiNGAMは、VTS法に分類され、健康な被験者のグループなど被験者間の変動が少ない場合に適している。

### 研究の目的
- 本研究では、被験者間のデータポイントをプールすることでpLiNGAMを用いて有効結合推定が可能かどうかを検証した。

- シミュレーションデータを用いてpLiNGAMの妥当性を評価
- 実際のfMRIデータを用いてpLiNGAMの実用性を検証

## Materials and Methods
### LiNGAMの復習
- x_i = Σ b_i,j x_j + e_j + c_i みたいなやつ
- b_i,j は重み係数
- k(i)は変数の因果順序です。

### 誤差項の特性
- 非ガウス分布に従う
- 分散が0ではない
- 互いに独立している


### 提案手法 pLiNGAM
- 複数の被験者のデータを結合するpLiNGAMアルゴリズム

#### 仮想被験者(V-subject)
- pLiNGAMでは、複数の被験者のデータを結合し、1つの仮想被験者を作成。
- V-subjectでは、複数の被験者データから生成されるため、被験者の変動を無視できることが前提

### pLiNGAMの手順
- 仮想被験者の生成
    - 被験者n人かランダムにm人を選び、それぞれのデータを結合して1つのV-sunjectを作成
    - 1つのV-subjectのデータ長はLm = m x Lsです(Lsは1人の被験者データの長さ)
- LiNGAMアルゴリズムの適用
    - V-subjectに対し、LiNGAMアルゴリズムを適用します。
    - 非線形関数は[tanh]ではなく[skew]を使用します。

### エラー評価指標
pLiNGAMアルゴリズムの誤差は以下の指標で評価されます。

- FPR: 誤って追加されたエッジの割合
- FNR: 見逃されたエッジの割合
- FDR: 誤った方向で推定されたエッジの割合

この３つの合計が総誤差を示す。

## Simulated fMRI Date

## Real fMRI Date
### 実験の参加者
- 被験者数: 12名の健全な若年層(右利き)
- 性別: 男性５名、女性７名
- 平均年齢: 21歳

### データ取得方法


### データ解析
- データ前処理
    - 最初の５ボリュームを除去し、信号の安定性を確保(???????)
    - 画像前処理として以下の処理を実施
        - スライスタイミング補正
        - 位置合わせ(リアラインメント)
        - 正規化
        - 平滑化
    
    - DMNと関心領域
        - 前処理後のデータに対してGroup ICAを実施してDMNを特定

        - Group ICAでは
            - PCAを２回実施して、次元を圧縮
            - ICA分離で独立成分を抽出(Extended Infomaxアルゴリズム)
            - バックリコンストラクションで被験者レベルのデータを再構築

    - DMNテンプレートの作成とt検定

    - 関心領域の設定
        - Table1
        - 今回の推定で用いる脳の座標プロット
    
    - 実fMRIデータに対するpLiNGAMの適用
        - 実データが非ガウス分布である場合、pLiNGAMアルゴリズムを適用してDMNの関心領域間の有効結合ネットワークwp推定

## Result

## Discussion



## 最終的にどのような発表内容でいくか

1. 導入
    1. LiNGAMアルゴリズムは十分多いデータ数があるときに安定性、収束性がある。
    1. 実データの中でデータ数が少ないものに対してもLiNGAMを用いて有効結合に関して推定したい。
    1. pLiNGAMという手法を提案しており、その有効性に関してシミュレートデータと実データを用いて実験している。
1.　fMRIの原理に関して
    1. https://www.tyojyu.or.jp/net/kenkou-tyoju/tyojyu-iryo/fmri-shikumi.html#:~:text=%E7%A3%81%E6%B0%97%E5%85%B1%E9%B3%B4%E6%A9%9F%E8%83%BD%E7%94%BB%E5%83%8F%E6%B3%95%EF%BC%88functional%20magnetic%20resonance%20imaging%2C%20fMRI,%E4%BB%95%E7%B5%84%E3%81%BF%E3%81%AB%E3%81%AA%E3%81%A3%E3%81%A6%E3%81%84%E3%81%BE%E3%81%99%E3%80%82 を引用しよう
    1. fMRIが何をしているか大まかに説明する。

1. fMRIをLiNGAMに当てる時の問題点
    1. fMRIのデータ数はLiNGAMを当てるには少ない
        1. 
1. pLinGAMアルゴリズムの説明
    1. LiNGAMモデルとは大きく変わるところはない。
    1. N人の観測者からランダムにm人を選んで結合
1. シミュレーションデータを用いた実験
1. 実データを用いた実験
1. 実験結果からの考察とこれからの課題
